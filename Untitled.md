### Exercise 1
The following is the extended method by hand:
![[Pasted image 20250422182435.png]]

### Exercise 2
To approximate the integral we use the following code:

```cpp
        double extended_midpoint(double (*func)(double), double a, double b, int N){ if (N <= 0) { throw std::invalid_argument("N must be greater than 0"); } if (N == 1) {
                return (b - a) * func((a + b) / 2);
            }

            double mid = (a + b) / 2;
            return extended_midpoint(func, a, mid, N / 2) + extended_midpoint(func, mid, b, N / 2);
        }


        void richardson_extrapolation(double (*func)(double), double (*method)(double (*)(double), double, double, int), double a, double b, double threshold, int its, int method_type){

            std::vector<double> a_h;
            double alpha_k = 0.0;
            double a_diff = 0.0;
            double order = 2;
            double richardson_error = threshold + threshold * 10;
            int f_calcs = 0;
            int N = 2;


            switch (method_type) {
                case 2:
                    f_calcs = 3;
                    break;
                case 3:
                    f_calcs = 3;
                    order = 4;
                    break;
                default:
                    break;
            }

            for (int i = 1; i < its; ++i) {
                a_h.push_back(method(func, a, b, pow(2, i - 1)));
            }

            std::cout << std::setw(3) << "i"
                << std::setw(20) << "A(h_i)"
                << std::setw(25) << "A(h_{i-1}) - A(h_i)"
                << std::setw(15) << "alpha_k"
                << std::setw(30) << "Richardson Error Est."
                << std::setw(15) << "f-comps"
                << std::endl;
            std::cout << std::string(120, '-') << std::endl;

            int i = 1;
            while (abs(richardson_error) > threshold){

                N = pow(2, i-1);
                if (i > 1){
                    a_diff = a_h[i-1] - a_h[i];
                }
                if (i > 2){
                    alpha_k = (a_h[i-2] - a_h[i-1])/(a_h[i-1] - a_h[i]);
                    richardson_error = (a_h[i-1]-a_h[i-2])/(alpha_k - 1);
                }

                switch(method_type) {
                    case 1:
                        f_calcs = pow(2, i-1);
                        break;

                    case 2:
                        f_calcs = (f_calcs * 2) - 1;
                        break;
                }

                std::cout << std::setw(3) << i
                << std::setw(20) << std::fixed << std::setprecision(8) << a_h[i - 1]
                << std::setw(25) << std::setprecision(8) << a_diff
                << std::setw(15) << std::setprecision(5) << alpha_k
                << std::setw(30) << std::setprecision(8) << richardson_error
                << std::setw(15) << f_calcs
                << std::endl;


                i++;
            }
            
        }
```

This gives us:

```bash
    1.13552
  i              A(h_i)      A(h_{i-1}) - A(h_i)        alpha_k         Richardson Error Est.        f-comps
------------------------------------------------------------------------------------------------------------------------
  1         -0.05569560               0.00000000        0.00000                    0.01100000              1
  2          0.38073718              -0.24856900        0.00000                    0.01100000              2
  3          0.62930618              -0.38120957        0.65205                   -0.71438840              4
  4          1.01051575              -0.12500285        3.04961                    0.18599153              8
  5          1.13551859              -0.07921297        1.57806                    0.21624531             16
  6          1.21473156              -0.06323224        1.25273                    0.31342844             32
  7          1.27796381              -0.04482907        1.41052                    0.15403013             64
  8          1.32279288              -0.03152180        1.42216                    0.10618949            128
  9          1.35431467              -0.02221903        1.41868                    0.07528774            256
 10          1.37653371              -0.01568507        1.41657                    0.05333774            512
 11          1.39221878              -0.01108099        1.41549                    0.03775052           1024
 12          1.40329977              -0.00783102        1.41501                    0.02670039           2048
 13          1.41113079              -0.00553461        1.41492                    0.01887363           4096
 14          1.41666540              -0.00391091        1.41517                    0.01333084           8192
 15          1.42057631              -0.00276212        1.41591                    0.00940333          16384
 16          1.42333843              -0.00194861        1.41748                    0.00661612          32768
 17          1.42528704              -0.00137159        1.42069                    0.00463192          65536
 18          1.42665863              -0.00096109        1.42712                    0.00321124         131072
 19          1.42761972              -0.00066745        1.43994                    0.00218459         262144
 20          1.42828717              -0.00045549        1.46535                    0.00143429         524288
 21          1.42874266              -0.00030060        1.51529                    0.00088395        1048576
```

### Exercise 3
We use the following DE method:
```cpp
	void DE_simple(double (*func)(double), double a, double b, int N) {
		const double hmax = 4.3;
		const double h = hmax / N;
		const double c = 1.0;

		double result = 0.0;

		for (int j = -N; j <= N; ++j) {
			double t = j * h;

			double sinh_t = std::sinh(t);
			double tanh_sinh_t = std::tanh(c * sinh_t);
			double x = 0.5 * (b + a) + 0.5 * (b - a) * tanh_sinh_t;

			double dx_dt = 0.5 * (b - a) * std::pow(1.0 / std::cosh(c * sinh_t), 2) * c * std::cosh(t);

			double weight = dx_dt;

			result += func(x) * weight;
		}

		result *= h;

		std::cout << "Simple DE Approximation: " << result << std::endl;
	}
```

and we get the following output
```bash
  j                   t         sinh_t         tanh_sinh_t              x               dx_dt         weight                  func(x)
-25         -4.30000000   -36.84311257         -1.00000000     0.00000000          0.00000000     0.00000000          316227.75293128
-24         -4.12800000   -31.01878814         -1.00000000     0.00000000          0.00000000     0.00000000          316227.75293128
-23         -3.95600000   -26.11438811         -1.00000000     0.00000000          0.00000000     0.00000000          316227.75293128
-22         -3.78400000   -21.98446266         -1.00000000     0.00000000          0.00000000     0.00000000          316227.75293128
-21         -3.61200000   -18.50653055         -1.00000000     0.00000000          0.00000000     0.00000000          316220.73149907
-20         -3.44000000   -15.57744674         -1.00000000     0.00000000          0.00000000     0.00000000          314379.82571192
-19         -3.26800000   -13.11034337         -1.00000000     0.00000000          0.00000000     0.00000000          194664.05933940
-18         -3.09600000   -11.03205353         -1.00000000     0.00000000          0.00000002     0.00000002           30765.56097735
-17         -2.92400000    -9.28094138         -0.99999998     0.00000003          0.00000065     0.00000065            5364.99235835
-16         -2.75200000    -7.80507416         -0.99999967     0.00000066          0.00001046     0.00001046            1226.49878932
-15         -2.58000000    -6.56068208         -0.99999600     0.00000801          0.00010629     0.00010629             353.37409885
-14         -2.40800000    -5.51086019         -0.99996731     0.00006537          0.00073225     0.00073225             123.67482344
-13         -2.23600000    -4.62447391         -0.99980759     0.00038481          0.00364104     0.00364104              50.95740079
-12         -2.06400000    -3.87523568         -0.99913929     0.00172142          0.01377292     0.01377292              24.06076023
-11         -1.89200000    -3.24092535         -0.99694273     0.00611454          0.04141389     0.04141389              12.71050138
-10         -1.72000000    -2.70273116         -0.99105622     0.01788756          0.10263560     0.10263560               7.34439457
 -9         -1.54800000    -2.24469188         -0.97779420     0.04441161          0.21584760     0.21584760               4.53904024
 -8         -1.37600000    -1.85322345         -0.95204861     0.09590278          0.39422219     0.39422219               2.93382489
 -7         -1.20400000    -1.51671607         -0.90812366     0.18375268          0.63697927     0.63697927               1.94120782
 -6         -1.03200000    -1.22518996         -0.84117846     0.31764309          0.92491109     0.92491109               1.29079292
 -5         -0.86000000    -0.96999931         -0.74870398     0.50259204          1.22442822     1.22442822               0.84646688
 -4         -0.68800000    -0.74357593         -0.63130080     0.73739841          1.49902443     1.49902443               0.51287530
 -3         -0.51600000    -0.53920479         -0.49238579     1.01522842          1.72133168     1.72133168               0.18004913
 -2         -0.34400000    -0.35082485         -0.33710686     1.32578627          1.87864452     1.87864452              -0.15883484
 -1         -0.17200000    -0.17284933         -0.17114826     1.65770349          1.97020485     1.97020485              -0.02315104
  0          0.00000000     0.00000000          0.00000000     2.00000000          2.00000000     2.00000000              -0.01392384
  1          0.17200000     0.17284933          0.17114826     2.34229651          1.97020485     1.97020485               0.06027544
  2          0.34400000     0.35082485          0.33710686     2.67421373          1.87864452     1.87864452               0.04058719
  3          0.51600000     0.53920479          0.49238579     2.98477158          1.72133168     1.72133168               0.00328834
  4          0.68800000     0.74357593          0.63130080     3.26260159          1.49902443     1.49902443              -0.02088681
  5          0.86000000     0.96999931          0.74870398     3.49740796          1.22442822     1.22442822               0.00582874
  6          1.03200000     1.22518996          0.84117846     3.68235691          0.92491109     0.92491109               0.01239015
  7          1.20400000     1.51671607          0.90812366     3.81624732          0.63697927     0.63697927               0.00637088
  8          1.37600000     1.85322345          0.95204861     3.90409722          0.39422219     0.39422219              -0.01003020
  9          1.54800000     2.24469188          0.97779420     3.95558839          0.21584760     0.21584760               0.00567784
 10          1.72000000     2.70273116          0.99105622     3.98211244          0.10263560     0.10263560               0.00888894
 11          1.89200000     3.24092535          0.99694273     3.99388546          0.04141389     0.04141389               0.00590997
 12          2.06400000     3.87523568          0.99913929     3.99827858          0.01377292     0.01377292               0.00427969
 13          2.23600000     4.62447391          0.99980759     3.99961519          0.00364104     0.00364104               0.00374517
 14          2.40800000     5.51086019          0.99996731     3.99993463          0.00073225     0.00073225               0.00361524
 15          2.58000000     6.56068208          0.99999600     3.99999199          0.00010629     0.00010629               0.00359183
 16          2.75200000     7.80507416          0.99999967     3.99999934          0.00001046     0.00001046               0.00358883
 17          2.92400000     9.28094138          0.99999998     3.99999997          0.00000065     0.00000065               0.00358857
 18          3.09600000    11.03205353          1.00000000     4.00000000          0.00000002     0.00000002               0.00358856
 19          3.26800000    13.11034337          1.00000000     4.00000000          0.00000000     0.00000000               0.00358856
 20          3.44000000    15.57744674          1.00000000     4.00000000          0.00000000     0.00000000               0.00358856
 21          3.61200000    18.50653055          1.00000000     4.00000000          0.00000000     0.00000000               0.00358856
 22          3.78400000    21.98446266          1.00000000     4.00000000          0.00000000     0.00000000               0.00358856
 23          3.95600000    26.11438811          1.00000000     4.00000000          0.00000000     0.00000000               0.00358856
 24          4.12800000    31.01878814          1.00000000     4.00000000          0.00000000     0.00000000               0.00358856
 25          4.30000000    36.84311257          1.00000000     4.00000000          0.00000000     0.00000000               0.00358856
Simple DE Approximation: 1.45217410
```

It can be seen that this is fairly close to the extended midpoint method with Richardson.